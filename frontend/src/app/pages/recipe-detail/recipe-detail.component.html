<app-container>
  <mat-card>
    <mat-card-header>
      <mat-card-title>
        Recipe for {{ recipe.coffeeBeanName }} using
        {{ formatBrewMethod(recipe) }}
      </mat-card-title>
    </mat-card-header>
    <mat-card-content class="attributes">
      <div class="description">
        <div>
          <strong>Description</strong>
        </div>
        <div [innerHTML]="recipe.extractionRecipeSteps"></div>
      </div>
      <div class="attribute">
        <strong>Roast</strong>
        <span>{{ formatRoast() }}</span>
      </div>
      <div class="attribute">
        <strong>Strength</strong>
        <span>{{ recipe.coffeeBeanStrength }}</span>
      </div>
      <div class="attribute">
        <strong>Blend</strong>
        <span>{{ recipe.coffeeBeanBlend }}</span>
      </div>
      <div class="attribute vertical-separator">
        <strong>Body</strong>
        <span>{{ recipe.extractionBody }}/5</span>
      </div>
      <div class="attribute">
        <strong>Acidity</strong>
        <span>{{ recipe.extractionAcidity }}/5</span>
      </div>
      <div class="attribute">
        <strong>Aromatics</strong>
        <span>{{ recipe.extractionAromatics }}/5</span>
      </div>
      <div class="attribute">
        <strong>Sweetness</strong>
        <span>{{ recipe.extractionSweetness }}/5</span>
      </div>
      <div class="attribute">
        <strong>Aftertaste</strong>
        <span>{{ recipe.extractionAftertaste }}/5</span>
      </div>
    </mat-card-content>
    <mat-card-actions>
      <div class="button-row">
        <a
          [disabled]="!recipe.coffeeBeanUrl"
          mat-stroked-button
          [href]="recipe.coffeeBeanUrl"
          target="_blank">
          <mat-icon>open_in_new</mat-icon>
          Buy Coffee
        </a>
        <button
          *ngIf="recipe.extractionId && recipe.shared"
          mat-stroked-button
          (click)="editRecipe()">
          <mat-icon>share</mat-icon>
          Unshare
        </button>
        <button
          *ngIf="recipe.extractionId && !recipe.shared"
          mat-stroked-button
          (click)="editRecipe()">
          <mat-icon>share</mat-icon>
          Share
        </button>
        <button
          mat-stroked-button
          [routerLink]="[
            '/coffee/' +
              recipe.coffeeBeanId +
              '/extraction/' +
              recipe.extractionId +
              '/edit'
          ]">
          <mat-icon>edit</mat-icon>
          Edit Extraction
        </button>
        <button mat-stroked-button color="warn" (click)="deleteRecipe()">
          <mat-icon>delete</mat-icon>
          Delete Recipe
        </button>
        <button
          mat-flat-button
          class="shareButton"
          type="button"
          (click)="shareOnReddit()">
          Share<mat-icon svgIcon="reddit_logo"></mat-icon>
        </button>
      </div>
    </mat-card-actions>
  </mat-card>
  <mat-card>
    <mat-card-header>
      <mat-card-title> Ratings from other users </mat-card-title>
      <mat-card-subtitle>
        Other users can rate your recipe and also leave a remark if they like
        to.
      </mat-card-subtitle>
    </mat-card-header>
    <mat-card-content>
      <p *ngIf="ratings.length === 0">
        There are no ratings yet for this recipe.
      </p>
      <mat-card *ngFor="let rating of ratings">
        <mat-card-header>
          <mat-card-title>
            {{ rating.authorUsername }},
            {{ rating.timestamp | date: 'yyyy-MM-dd HH:mm' }}
          </mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <div class="rating">
            <mat-icon
              class="rate-star"
              *ngFor="let i of [1, 2, 3, 4, 5]; let x = index">
              {{ i <= rating.rating ? 'star' : 'star_border' }}
            </mat-icon>
          </div>
          {{ rating.text }}
        </mat-card-content>
        <mat-card-actions>
          <div class="button-row">
            <button mat-stroked-button>
              <mat-icon>edit</mat-icon> Edit Rating
            </button>
            <button mat-stroked-button color="warn">
              <mat-icon>delete</mat-icon> Delete Rating
            </button>
          </div>
        </mat-card-actions>
      </mat-card>
    </mat-card-content>
  </mat-card>
</app-container>
